KISSY.add("wt-detail/c/util/index",function(e){"use strict";var t={"isDaily":function(){return location.hostname.indexOf(".daily.")>-1},"getHostName":function(){return"//"+(t.isDaily()?"wtt.daily.tmall.net":"wt.tmall.com")},"unparamUrl":function(){return e.unparam(location.search.replace("?",""))},"getUrlParam":function(e){return t.unparamUrl()[e]}};return t});KISSY.add("wt-detail/c/category-selector/index",function(e,t,a,n,r,i,l,o){"use strict";function d(e){if(!e||!e.renderTo)throw"bad params, must input a json object as param, and must input properties: renderTo!";d.superclass.constructor.call(this,e),this.config=e||{},this.data=e.data||[],this.superObj=e.superObj||{},this.$renderTo=c(e.renderTo),this._curCateSection=null,this._allCateSection=[],this._allCateSectionMap={},this._init(),this.regConfigEvents(e)}var c=a.all,s="tb-out-of-stock",u="tb-selected",v="change";return e.extend(d,i,{"_init":function(){var e=this;e._render(),e._bindEvent()},"_render":function(){var e=this,t=e.data||[];e.$content=c(l(t)),e.$renderTo.append(e.$content)},"_bindEvent":function(){var e=this,t=e.$content,a=t.all("li");t.delegate("click","li",function(t){t.preventDefault();var n=c(t.currentTarget);if(!n.hasClass(s)){if(n.hasClass(u))n.removeClass(u);else{a.removeClass(u),n.addClass(u);var r=e._getSelectedVersionCode();r&&99!=r&&goldlog&&goldlog.record("/alitx.21.2.15.5","","","H46896572")}e._switchCateSection()}})},"_hideCateSections":function(){for(var e=this,t=e._allCateSection||[],a=0,n=t.length;a<n;a++)t[a].hide()},"_switchCateSection":function(){var e=this,t=e.superObj.getSelectedSkuId(),a=e._curCateSection,n=e._getSelectedCate(),r=e._getSelectedCateSection(t,n);r&&r==a||(e._hideCateSections(),r?(r.show(),e._curCateSection=r):e._curCateSection=null,e.fire(v,n))},"_createCateSection":function(e,t){var a=this,n=c(o({"skuId":e,"cate":t}));return a.$renderTo.append(n),a._allCateSection.push(n),a._allCateSectionMap[e]||(a._allCateSectionMap[e]={}),a._allCateSectionMap[e][t.versionCode+"_"+t.planId]=n,n},"_fireSelected":function(e){var t=this,a=t.data||[],n=null;if(console.log("_fireSelected"),e)for(var r=0,i=a.length;r<i;r++){var l=a[r]||{};if(l.versionCode==e){n=e;break}}else for(var r=0,i=a.length;r<i;r++){var l=a[r]||{};if(l.selected){n=l.versionCode;break}}if(!n&&a[0]&&(n=a[0].versionCode),n){var o=t._getCateLabelByVerCode(n);o&&o.fire("click")}},"_fireSelectedOnce":function(){var e=this;e.fired||e._fireSelected(r.getUrlParam("version_code")),e.fired=!0},"_getCateLabelByVerCode":function(e){for(var t=this,a=t.$content.all("li"),n=0,r=a.length;n<r;n++){var i=a.item(n);if(e==i.attr("data-versionCode"))return i}return null},"_getCurCateSection":function(){return this._curCateSection},"_getSelectedCateSection":function(e,t){if(t&&(!t.isSkuRelate||e)){t.isItemRelate&&(e=0);var a=this,n=a._getCateSectionBySkuIdAndVerCode(e,t.versionCode,t.planId);return n?n:a._createCateSection(e,t)}},"_getCateSectionBySkuIdAndVerCode":function(e,t,a){var n=this,r=t+"_"+a;return n._allCateSectionMap[e]&&n._allCateSectionMap[e][r]?n._allCateSectionMap[e][r]:null},"_getSelectedCate":function(){for(var t=this,a=t.data||[],n=t.$content.all("li."+u),r=n.attr("data-planid"),i=n.attr("data-versionCode"),l=0,o=a.length;l<o;l++){var d=a[l]||{};if(i==d.versionCode){if(!d.planId)return e.clone(d);if(d.planId==r)return e.clone(d)}}return null},"_getSelectedVersionCode":function(){var e=this,t=e._getSelectedCate();return t?t.versionCode:""},"_getItemRelateCatesData":function(){for(var t=this,a=t.data||[],n=[],r=0,i=a.length;r<i;r++){var l=a[r]||{};l.isItemRelate||n.push(e.clone(l))}return n.length?n:null},"_getSkuRelateCatesData":function(){for(var t=this,a=t.data||[],n=[],r=0,i=a.length;r<i;r++){var l=a[r]||{};l.isSkuRelate&&n.push(e.clone(l))}return n.length?n:null},"_getItemRelateVerCodes":function(){for(var e=this,t=e._getItemRelateCatesData()||[],a=[],n=0,r=t.length;n<r;n++){var i=t[n]||{};a.push(i.versionCode)}return a.length?a:null},"_getSkuRelateVerCodes":function(){for(var e=this,t=e._getSkuRelateCatesData()||[],a=[],n=0,r=t.length;n<r;n++){var i=t[n]||{};a.push(i.versionCode)}return a.length?a:null},"_setDisabledByVerCodes":function(t){for(var a=this,n=a.$content.all("li"),r=function(t,a){var n=e.filter(a,function(e){return t==e});return!!n[0]},i=0,l=n.length;i<l;i++){var o=n.item(i),d=o.attr("data-versionCode");r(d,t)&&(o.removeClass(u),o.addClass(s))}},"_setUnDisabledByVerCodes":function(t){for(var a=this,n=a.$content.all("li"),r=function(t,a){var n=e.filter(a,function(e){return t==e});return!!n[0]},i=0,l=n.length;i<l;i++){var o=n.item(i),d=o.attr("data-versionCode");r(d,t)&&o.removeClass(s)}},"_setAllSkuRelateDisabled":function(){var e=this,t=e._getSkuRelateVerCodes()||[];e._setDisabledByVerCodes(t)},"_setAllSkuRelateUnDisabled":function(){var e=this,t=e._getSkuRelateVerCodes()||[];e._setUnDisabledByVerCodes(t)},"_setSkuRelateDisabledAndUnDisabled":function(e){for(var t=this,a=t._getSkuRelateCatesData()||[],n=[],r=[],i=function(e,t){for(var a=0,n=t.length;a<n;a++)if(e==t[a])return!0;return!1},l=0,o=a.length;l<o;l++){var d=a[l]||{},c=d.skuId||[];i(e,c)?r.push(d.versionCode):n.push(d.versionCode)}t._setDisabledByVerCodes(n),t._setUnDisabledByVerCodes(r)},"_setSkuRelateDisabledBySkuId":function(e){var t=this;e?t._setSkuRelateDisabledAndUnDisabled(e):t._setAllSkuRelateDisabled(),t._switchCateSection()},"getCurCateSection":function(){return this._getCurCateSection()},"getCateSectionBySkuIdAndVerCode":function(e,t,a){return this._getCateSectionBySkuIdAndVerCode(e,t,a)},"getSelectedCate":function(){return this._getSelectedCate()},"getSelectedVersionCode":function(){return this._getSelectedVersionCode()},"curSelectedVerIsItemRelate":function(){var e=this,t=e._getSelectedCate()||{};return!!t.isItemRelate},"change":function(e){var t=this;t._setSkuRelateDisabledBySkuId(e),t._fireSelectedOnce()},"destroy":function(){var e=this,t=e.$content;t.undelegate("click"),t.parent().remove()}}),d},{"requires":["dom","node","event","wt-detail/c/util/index","wt-detail/c/event-manager/index","./index.mtpl","./section.mtpl","./index.css"]});KISSY.add("wt-detail/c/area-selector/index",function(e,t,a,n,r,i,d){"use strict";function c(e){if(!e||!e.renderTo)throw"bad params, must input a json object as param, and must input properties: renderTo!";c.superclass.constructor.call(this,e),this.config=e||{},this.data=e.data||[],this.$renderTo=l(e.renderTo),this._checkedArea=null,this._init(),this.regConfigEvents(e)}var l=a.all,o="wt-area-selected",s="wt-prov-selected",u="wt-city-selected",m="tb-selected",v="change";return e.extend(c,r,{"_init":function(){var e=this;e._render(),e._bindEvent()},"_render":function(){var e=this;e._renderIndex()},"_bindEvent":function(){var e=this,t=e.$content,a=e.$area,n=e.$areaSection;n.delegate("click",".j_Prov",function(e){e.preventDefault();var t=l(e.currentTarget),a=t.attr("data-value");return t.hasClass(s)||(n.all(".j_CityGroup").hide(),n.all(".j_CityGroup_"+a).show(),n.all(".j_Prov").removeClass(s),t.addClass(s)),!1}).delegate("click",".j_City",function(t){t.preventDefault();var a=l(t.currentTarget);if(!a.hasClass(u)){n.all("."+u).removeClass(u),a.addClass(u);var r=e._getCheckedArea();e._checkedArea=r,e._setCheckedArea(r),e.fire(v,r),e.$area.removeClass(o)}return!1}),t.delegate("click",".j_AreaTrigger",function(t){return t.preventDefault(),a.hasClass(o)?a.removeClass(o):(a.addClass(o),e._renderArea()),!1}),l(document.body).on("click",function(e){a.hasClass(o)&&a.removeClass(o)})},"_renderIndex":function(){var e=this,t=e.data||[],a=function(){for(var e=0,a=t.length;e<a;e++)for(var n=t[e]||{},r=n.city||[],i=0,d=r.length;i<d;i++){var c=r[i]||{};if(c.selected)return{"proCode":n.code,"proName":n.name,"cityCode":c.code,"cityName":c.name}}return null}();e.$content=l(i(a)),e.$renderTo.append(e.$content),e.$area=e.$content.all(".j_Area"),e.$areaSection=e.$content.all(".j_AreaSection"),a&&(e._checkedArea=a,setTimeout(function(){e.fire(v,a)},10))},"_renderArea":function(){var t=this,a=t.data||[],n=t._checkedArea,r=function(){var t=e.clone(a)||[];if(n)for(var r=n.cityCode,i=0,d=t.length;i<d;i++){for(var c=t[i]||{},l=c.city||[],o=!1,s=0,u=l.length;s<u;s++){var m=l[s]||{},v=m.code||"";r==v?(o=!0,c.selected=!0,m.selected=!0):m.selected=!1}o||(c.selected=!1)}return t}();t.$areaSection.html(d(r))},"_getCheckedArea":function(){var e=this,t=e.$areaSection.all("."+u);if(t.length){var a=t.parent(".j_CityGroup");return{"proCode":a.attr("data-value"),"proName":a.attr("data-name"),"cityCode":t.attr("data-value"),"cityName":t.attr("data-name")}}return null},"_setCheckedArea":function(e){var t=this,a=t.$content,n=a.all(".j_AreaName"),r=a.all(".j_AreaTrigger");n.html(e.cityName),r.addClass(m)},"getCheckedArea":function(){return this._checkedArea},"getCheckedCityData":function(){var t=this,a=t.data||[],n=t._checkedArea;if(n)for(var r=n.cityCode,i=0,d=a.length;i<d;i++)for(var c=a[i]||{},l=c.city||[],o=0,s=l.length;o<s;o++){var u=l[o]||{};if(r==u.code)return e.clone(u)}return null},"getCheckedAreaNetworkData":function(){var t=this,a=t.getCheckedCityData(),n=a&&a.network||[];return e.clone(n)},"destroy":function(){var e=this,t=e.$content;t.undelegate("click"),t.parent().remove()}}),c},{"requires":["dom","node","event","wt-detail/c/event-manager/index","./index.mtpl","./area.mtpl","./index.css"]});KISSY.add("wt-detail/c/plan-selector/index",function(e,t,a,n,r,i,l,o){"use strict";function s(e){if(!e||!e.renderTo)throw"bad params, must input a json object as param, and must input properties: renderTo!";s.superclass.constructor.call(this,e),this.config=e||{},this.data=e.data||[],this.superObj=e.superObj||{},this.categoryId=e.categoryId||null,this.$renderTo=c(e.renderTo),this._disabledPlanIds=[],this._init(),this.regConfigEvents(e)}var c=a.all,d="tb-out-of-stock-hide",u="tb-selected",h="change";return e.extend(s,i,{"_init":function(){var e=this;e._render(),e._bindEvent();for(var t,a=e.$content.all("li"),n=0,r=a.length;n<r;n++)if(t=c(a[n]),!t.hasClass(d)){t.fire("click");break}},"_render":function(){var e=this,t={"list":e.data||[],"categoryName":e._getCategoryName()};e.$content=c(l(t)),e.$renderTo.append(e.$content)},"_bindEvent":function(){var e=this,t=e.$content,a=t.all("li");t.delegate("click","li",function(t){t.preventDefault();var n=c(t.currentTarget);if(!n.hasClass(d)){n.hasClass(u)?n.removeClass(u):(a.removeClass(u),n.addClass(u));var r=e.getSelectedPlan();r?e._showTips(r):e._hideTips(),e.fire(h,r)}}).delegate("click",".j_showPlanDetail",function(t){t.preventDefault(),e._showPlanDetail(),goldlog&&goldlog.record("/alitx.21.2.15.1","","","H46896547")})},"_getCategoryName":function(){return 1001==this.categoryId||1010==this.categoryId?"\u4f18\u60e0\u6d3b\u52a8":"\u5408\u7ea6\u5957\u9910"},"_showTips":function(e){var t=this.$tips||(this.$tips=this.$content.all(".j_Tips")),a=e.isShowPlanContrast?e.feeRuleMemo+' <a class="j_showPlanDetail wt-plandetail-link" href="javascript:void(0)">\u5957\u9910\u8be6\u60c5\u5bf9\u6bd4</a>':e.feeRuleMemo;t.attr("data-planId",e.planId),t.html(a),t.show()},"_hideTips":function(){var e=this.$tips||(this.$tips=this.$content.all(".j_Tips"));e.attr("data-planId",""),e.html(""),e.hide()},"_showPlanDetail":function(){var e=this,t=new r.Dialog({"width":830,"height":430,"bodyContent":"","closable":!0,"closeAction":"destroy","mask":!0,"showCat":!0,"align":{"points":["cc","cc"]}});t.on("afterRenderUI",function(){var t=this;e._renderPlanDetail(t),e._bindPlanDetailEvent(t)}),t.show()},"_renderPlanDetail":function(t){var a=this,n=a.superObj,r=a.getSelectedPlan(),i=e.clone(a.data||[]);if(r){var l=r.planId;e.each(i,function(e){e.planId==l&&(e.checked=!0)})}else i[0]&&(i[0].checked=!0);n.product.onLoad(["buyPrice"],function(e){t.$el.all(".mui-dialog-body").html(o({"list":i||[],"buyPrice":e||{},"disabledPlanIds":a._disabledPlanIds||[]}));var n=t.$el,r=n.all(".j_ScrollBody"),l=n.all(".j_PlanId:checked"),s=l.parent("tr"),c=s.offset().top,d=r.offset().top;c-d>r.height()-s.height()/2&&r.scrollTop(c-d)})},"_bindPlanDetailEvent":function(t){var a=this,n=t.$el,r=n.all(".j_ShowPlanTips"),i=n.all(".j_ShowTipsLink"),l=n.all(".j_ShowPriceTips"),o=c(".j_TipsDetail"),s=c(".j_TipsDetail2"),d=null,u=null;o.length||(o=c('<div class="j_TipsDetail wt-plandetail-tips"></div>'),o.appendTo(document.body)),s.length||(s=c('<div class="j_TipsDetail2 wt-plandetail-tips2"></div>'),s.appendTo(document.body)),n.delegate("click",".j_PlanId",function(t){t.stopPropagation();var a=c(t.currentTarget),n=e.trim(a.attr("data-fee"))||"",l=n.substr(0,30);n.length>30?(i.show(),r.html("\u8bdd\u8d39\u8fd4\u8fd8\u89c4\u5219\uff1a"+l+"..."),goldlog&&goldlog.record("/alitx.21.2.15.3","","","H46896570")):(r.html("\u8bdd\u8d39\u8fd4\u8fd8\u89c4\u5219\uff1a"+l),i.hide()),r.attr("data-fee",n)}).delegate("click",".j_PlanTr",function(e){e.preventDefault();var t=c(e.currentTarget),a=t.all(".j_PlanId");a.fire("click")}).delegate("click",".j_Ok",function(e){e.preventDefault();var r=n.all(".j_PlanId:checked"),i=r.val();a._firePlanSelect(i),t.destroy(),goldlog&&goldlog.record("/alitx.21.2.15.2","","","H46896569")}),i.on("mouseenter",function(e){e.preventDefault(),clearTimeout(d);var t=c(e.currentTarget),a=r.attr("data-fee"),n=(a.substr(0,300),t.offset());a.length>300?o.html('<div class="wt-plandetail-tips-inner">'+a+"...</div>"):o.html('<div class="wt-plandetail-tips-inner">'+a+"</div>"),o.css({"top":n.top,"left":n.left}).show(),goldlog&&goldlog.record("/alitx.21.2.15.4","","","H46896571")}).on("mouseleave",function(e){e.preventDefault(),d=setTimeout(function(){o.hide()},100)}),o.on("mouseenter",function(e){e.preventDefault(),clearTimeout(d)}).on("mouseleave",function(e){e.preventDefault(),d=setTimeout(function(){o.hide()},100)}),l.on("mouseenter",function(e){e.preventDefault(),clearTimeout(u);var t=c(e.currentTarget),a=t.attr("data-desc"),n=t.offset();s.html('<div class="wt-plandetail-tips2-inner">'+a+"</div>"),s.css({"top":n.top,"left":n.left}).show()}).on("mouseleave",function(e){e.preventDefault(),u=setTimeout(function(){s.hide()},100)}),s.on("mouseenter",function(e){e.preventDefault(),clearTimeout(u)}).on("mouseleave",function(e){e.preventDefault(),u=setTimeout(function(){s.hide()},100)});var h=n.all(".j_PlanId:checked");h.length&&h.item(0).fire("click")},"_firePlanSelect":function(e){for(var t=this,a=t.$content.all("li"),n=0,r=a.length;n<r;n++){var i=a.item(n);if(i.attr("data-planId")==e&&!i.hasClass(u)){i.fire("click");break}}},"getSelectedPlan":function(t){var a=this,n=null,r=a.data||[],i=(a.$content,a.$content.all("li."+u)),l=i.attr("data-planId"),o=function(t,a){for(var n=0,r=t.length;n<r;n++){var i=t[n]||{};if(a==i.planId)return e.clone(i)}return null};return t&&(n=o(r,t)),n||(n=o(r,l)),n},"getSelectedPlanId":function(){var e=this,t=e.getSelectedPlan();return t?t.planId:""},"setDisabled":function(e){var t=this;e?t.setDisabledByPlanIds(e):t.setAllDisabled(),t._disabledPlanIds=e||[]},"setAllDisabled":function(){var e=this,t=e.$content,a=t.all("li"),n=e.$tips||(e.$tips=e.$content.all(".j_Tips"));a.removeClass(u),a.addClass(d),n.hide(),e.fire(h,e.getSelectedPlan())},"setDisabledByPlanIds":function(e){for(var t=this,a=t.$content,n=a.all("li"),r=t.$tips||(t.$tips=t.$content.all(".j_Tips")),i=0,l=n.length;i<l;i++){for(var o=n.item(i),s=o.attr("data-planId"),c=!1,f=0,v=e.length;f<v;f++)s==e[f]&&(c=!0);c?(o.removeClass(u),o.addClass(d),s==r.attr("data-planId")&&r.hide()):o.removeClass(d)}t.fire(h,t.getSelectedPlan())},"destroy":function(){var e=this,t=e.$content;t.undelegate("click"),t.parent().remove()}}),s},{"requires":["dom","node","event","mui/overlay/index","wt-detail/c/event-manager/index","./index.mtpl","./detail.mtpl","./index.css","./detail.css"]});KISSY.add("wt-detail/c/number-selector/index",function(e,t,n,a,r,i,l,o,c,s,d){"use strict";function u(e){if(!e||!e.renderTo)throw"bad params, must input a json object as param, and must input properties: renderTo!";u.superclass.constructor.call(this,e),this.config=e||{},this.data=e.data||[],this.superObj=e.superObj||{},this.$renderTo=h(e.renderTo),this.dialog=null,this._params=null,this._selectedNum=null,this._selectNumData=null,this._selectedNetwork=null,this._init(),this.regConfigEvents(e)}var h=n.all,f=location.hostname.indexOf(".daily.")>-1,v="//"+(f?"wtt.daily.tmall.net":"wt.tmall.com"),m="wt-network-selected",g="wt-phonenum-selected",_="tb-selected",p="change",C="\u53f7\u7801\u62c9\u53d6\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5";return e.extend(u,o,{"_init":function(){_CTK5ef0(17,"numberSelector.init","wtdetail.init");var e=this;e._render(),e._bindEvent()},"_render":function(){_CTK5ef0(17,"numberSelector.render","numberSelector.init");var e=this;e.data||[];e.$content=h(c()),e.$renderTo.append(e.$content)},"_bindEvent":function(){_CTK5ef0(17,"numberSelector.bindEvent","numberSelector.init");var e=this,t=e.superObj;e.$content.delegate("click",".j_SelectNumLabel",function(n){n.preventDefault();var a=t.getSelectNumParams();a&&(e._params=a,e._popSelectNum())})},"_popSelectNum":function(){var e=this,t=e.dialog=new l.Dialog({"width":830,"height":430,"bodyContent":"","mask":!0,"showCat":!0,"align":{"points":["cc","cc"]}});t.on("afterRenderUI",function(){var t=this;e._renderNumCon(t),e._bindNumConEvent(t)}),t.show()},"_fetchSelectNum":function(t,n){_CTK5ef0(17,"numberSelector.fetchSelectNum","numberSelector.init");var a=this,l=v+"/trade/detail/itemOp.do?m=SelectNum",o=e.merge({"itemId":"","skuId":0,"provId":0,"cityId":0,"planId":0,"maxCount":25},t||{});a._hideSection(),a._showLoading(),_CTK5ef0(17,"numberSelector.fetchSelectNum.selectNum","numberSelector.init"),r({"url":l,"data":o,"dataType":"jsonp","success":function(e){_CTK5ef0(17,"numberSelector.fetchSelectNum.selectNum.success","numberSelector.init"),a._hideLoading();var t=e.code,r=e.data||{},l=e.message||C;0==t?(_CTK5ef0(17,"numberSelector.fetchSelectNum.selectNum.success.true","numberSelector.init"),a._selectNumData=r,n&&n(r)):(_CTK5ef0(0,"error:numberSelector.fetchSelectNum.selectNum.success.false","numberSelector.init",{"msg":i.stringify({"ret":e,"reqData":o}),"type":"error"}),a._hideSection(),a._showTips(l))},"error":function(e){_CTK5ef0(0,"error:numberSelector.fetchSelectNum.selectNum.error","numberSelector.init",{"msg":i.stringify({"ret":e,"reqData":o}),"type":"error"}),a._hideSection(),a._hideTips(C)}})},"_renderNumCon":function(t){var n=this,a=this.data||{},r=n.superObj.getCurAreaNetworkData()||[],i=function(){for(var t=[],n=0,i=a.length;n<i;n++)for(var l=a[n]||{},o=l.code,c=0,s=r.length;c<s;c++){var d=r[c];if(o==d){t.push(e.clone(l));break}}return t}(),l=function(){for(var e=i,t=!1,a=n._selectedNetwork,r=0,l=e.length;r<l;r++){var o=e[r]||{};a==o.code?o.selected=!0:o.selected=!1}for(var r=0,l=e.length;r<l;r++){var o=e[r]||{};if(o.selected){t=!0;break}}return!t&&e[0]&&(e[0].selected=!0,n._selectedNetwork=e[0].code),e}();t.$el.all(".mui-dialog-body").html(d(l))},"_bindNumConEvent":function(t){var n=this,a=t.$el,r=a.all(".j_SearchBarInput"),i=a.all(".j_SearchBarRefresh");a.delegate("click","li",function(e){e.preventDefault();var t=h(e.currentTarget),n=t.parent().all("li");t.hasClass(g)||(n.removeClass(g),t.addClass(g))}).delegate("click","dd",function(t){t.preventDefault();var a=h(t.currentTarget),i=a.parent().all("dd");a.hasClass(m)||(i.removeClass(m),a.addClass(m),n._selectedNetwork=e.trim(a.attr("data-code")),n.fetchSelectNum({"phoneNum":e.trim(r.val())}))}).delegate("click",".j_Ok",function(e){e.preventDefault();var a=n._selectedNum=n._getSelectedNum(),r=n._selectedNetwork,i=n._getSelecteNetworkName()||"";a&&(n.config.preUseNum?(n._hidePopError(),n.config.preUseNum.call(n.config.handlerContext,function(){n.fire(p,a),n._dialogDestroy(),n._setSelectedNum(a+(i?" "+i:"")),n.$content.all(".j_SelectNumAgain").show()},function(e){n._showPopError(t,e)})):(n.fire(p,a),n._dialogDestroy(),n._setSelectedNum(a+(i?" "+i:"")),n.$content.all(".j_SelectNumAgain").show()),n._lastSelectedNetwork=r)}).delegate("click",".j_SearchBarQuery",function(e){e.preventDefault(),a.all(".j_SearchBar1").hide(),a.all(".j_SearchBar2").show()}).delegate("click",".j_SearchBarClose",function(e){e.preventDefault(),r.val(""),a.all(".j_SearchBar2").hide(),a.all(".j_SearchBar1").show()}).delegate("click",".j_SearchBarRefresh",function(e){e.preventDefault(),n.fetchSelectNum()}).delegate("click",".j_SearchBarSearch",function(t){t.preventDefault(),n.fetchSelectNum({"phoneNum":e.trim(r.val())})}),r.on("input",function(e){var t=r.val();if(!/^\d{0,11}$/.test(t))return t=parseInt(t),void h(this).val(t||"")}).on("keydown",function(t){13==t.keyCode&&n.fetchSelectNum({"phoneNum":e.trim(r.val())})}),i.fire("click")},"_renderSelectNum":function(e){var t=this,n=t.dialog,a=n.$el,r=a.all(".j_SearchBarInput"),i=r.val(),l=function(){for(var e=t._selectedNum,n=t._selectNumData||[],a=0,r=n.length;a<r;a++){var i=n[a]||{};e==i.phoneNum&&(i.checked=!0)}return n}();t._showSection(s({"searchKey":i,"renderData":l}))},"_showSection":function(e){var t=this,n=t.dialog.$el.all(".j_PhonenumSection");n.html(e),n.show()},"_hideSection":function(){var e=this,t=e.dialog.$el.all(".j_PhonenumSection");t.html(""),t.hide()},"_showTips":function(e){var t=this,n=t.dialog.$el.all(".j_PhonenumTips");n.html(e),n.show()},"_hideTips":function(){var e=this,t=e.dialog.$el.all(".j_PhonenumTips");t.hide(),t.html("")},"_showLoading":function(){this._showTips("\u53f7\u7801\u8f7d\u5165\u4e2d...")},"_hideLoading":function(){this._hideTips()},"_showPopError":function(e,t){var n=this,a=e.$el.all(".j_Ok"),r=n.$errorDiv||(n.$errorDiv=h('<div class="j_ErrorMsg" style="padding-top: 10px; margin-bottom: -10px; color: #f00;"></div>'));r.insertBefore(a),r.html(t),r.show()},"_hidePopError":function(){var e=this,t=e.$errorDiv;t&&(t.html(""),t.hide())},"_dialogDestroy":function(){this.dialog&&this.dialog.destroy()},"_getSelectedNum":function(){var t=this,n=t.dialog.$el.all("li."+g);return n.length?e.trim(n.attr("data-phoneNum")):""},"_getSelecteNetworkName":function(){for(var e=this,t=e.data||[],n=e._selectedNetwork,a=0,r=t.length;a<r;a++){var i=t[a]||{};if(n==i.code)return i.name}return""},"_setSelectedNum":function(e){var t=this,n=t.$content.all(".j_SelectNum");n.html(e),n.parent("li").addClass(_)},"getSelectedNum":function(){return this._selectedNum},"getSelectedNetwork":function(){return this._selectedNetwork},"getLastSelectedNetwork":function(){return this._lastSelectedNetwork},"fetchSelectNum":function(t){var n=this;n._selectedNetwork&&(t=e.merge({"network":n._selectedNetwork},t)),t=e.merge(n._params,t),n._fetchSelectNum(t,function(e){n._renderSelectNum(e)})},"showErrorMsg":function(e){var t=this,n=t.$content.all(".j_SelectNumAgain"),a=t.$errorMsg||(t.$errorMsg=h('<li class="j_ErrorMsg" style="color: #f00;"></li>'));a.html(e),a.insertAfter(n)},"hideErrorMsg":function(){this.$errorMsg&&this.$errorMsg.remove()},"clear":function(){var e=this,t=e.$content,n=t.all(".j_SelectNum"),a=t.all(".j_SelectNumAgain");n.html(n.attr("data-default")),n.parent("li").removeClass(_),a.hide(),e._selectedNum=null,this._selectedNetwork=null},"destroy":function(){var e=this,t=e.$content;t.undelegate("click"),t.parent().remove()}}),u},{"requires":["dom","node","event","io","json","mui/overlay/index","wt-detail/c/event-manager/index","./index.mtpl","./num.mtpl","./numcon.mtpl","./index.css"]});KISSY.add("wt-detail/c/cardtype-selector/index",function(e,t,a,r,n,i){"use strict";function d(e){if(!e||!e.renderTo)throw"bad params, must input a json object as param, and must input properties: renderTo!";d.superclass.constructor.call(this,e),this.config=e||{},this.data=e.data||[],this.$renderTo=c(e.renderTo),this._init(),this.regConfigEvents(e)}var c=a.all,l="tb-out-of-stock",o="tb-selected",s="change";return e.extend(d,n,{"_init":function(){var e=this;e._render(),e._bindEvent()},"_render":function(){var e=this,t=e.data||[];e.$content=c(i(t)),e.$renderTo.append(e.$content)},"_bindEvent":function(){var e=this,t=e.$content,a=t.all("li");t.delegate("click","li",function(t){t.preventDefault();var r=c(t.currentTarget);r.hasClass(l)||(r.hasClass(o)?r.removeClass(o):(a.removeClass(o),r.addClass(o)),e.fire(s,e.getSelectedCardtype()))})},"getSelectedCardtype":function(){for(var t=this,a=t.data||[],r=t.$content.all("li."+o),n=r.attr("data-code"),i=0,d=a.length;i<d;i++){var c=a[i]||{};if(n==c.code)return e.clone(c)}return null},"getSelectedCardtypeCode":function(){var e=this,t=e.getSelectedCardtype();return t?t.code:""},"destroy":function(){var e=this,t=e.$content;t.undelegate("click"),t.parent().remove()}}),d},{"requires":["dom","node","event","wt-detail/c/event-manager/index","./index.mtpl","./index.css"]});